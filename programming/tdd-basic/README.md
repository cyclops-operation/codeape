<strong>TDD(Test-driven development)</strong>란 개발자가 **소프트웨어 코드를 작성하기 전에 먼저 테스트 코드를 작성**하는 소프트웨어 개발 방법론입니다.

> [!IMPORTANT]
>
> TDD는 테스트를 우선으로 작성하는 것이지, 테스트를 작성하는 것이 곧 TDD가 아닙니다.

## TDD의 탄생

TDD의 개념은 1990년대 후반, 켄트 백(Kent Beck)이 주도한 익스트림 프로그래밍(Extreme Programming, XP) 방법론의 일환으로 TDD가 본격적으로 도입외었습니다. 켄트 백은 1990년에 출판한 책 "Extreme Programming Explained"에서 TDD의 기본 원칙과 실천 방법을 소개했습니다. 빠르게 고품질의 소프트웨어를 개발할 수 있는 다양한 실천 방식 중 하나로 TDD가 제안된 것입니다.

이후 TDD는 애자일 방법론의 일환으로 널리 확산되고, TDD는 애자일의 반복적인 개발 프로세스를 효과적으로 지원했습니다. 이후 "Test-Driven Development by Example" (2002)라는 제목의 켄트 벡의 책은 TDD의 구체적인 실천 방법과 사례를 다루며 많은 개발자들에게 영향을 미치기도 했습니다.

## TDD의 단계

일반적으로 TDD는 다음의 단계를 따라 진행되며 이를 반복하는 과정으로 소프트웨어를 개발합니다.

- Red: 실패하는 단위 테스트를 작성합니다.
- Green: 테스트를 통과하기 위한 최소한의 코드를 작성하여 기능을 구성합니다.
- Refactor: 테스트를 통과했다면 코드의 중복을 개선하고 최적화합니다. 이 과정에서 테스트는 계속 통과해야 합니다.

이를 간단한 계산기 기능 구현을 테스트 하는 소스 코드 예제로 확인해보겠습니다. 예시 코드의 프로젝트 구조는 아래와 같다고 가정합니다.

```sh
/project
  ├── calculator.js
  └── calculator.test.js
```

### Red(테스트 작성)

```js
// calculator.test.js

import { add } from "./calculator";

test("adds 2 + 3 to equal 5", () => {
  expect(add(2, 3)).toBe(5);
});
```

아직 `add` 함수가 구현되지 않았기에 이는 실패하는 테스트일 것 입니다.

### Green(기능 구현)

```js
// calculator.js

export const add = (a, b) => a + b;
```

테스트를 통과하기 위해 `add` 함수를 구현합니다. 이후 `jest` 를 실행하여 테스트 통과 여부를 확인합니다.

### Refactor(코드 개선)

이후 구현한 코드의 가독성을 높인다거나 코드 중복을 제거하는 등의 리팩토링 과정을 거칩니다. 앞에서 언급한대로 리팩토링을 진행하면서 계속 테스트는 성공해야합니다.

해당 예제는 매우 간단한 코드이기에 개선 과정은 생략하겠습니다.

## TDD의 장단점

TDD를 활용했을 때 얻을 수 있는 장점으로 다음의 내용들이 있습니다.

- 높은 코드 품질: 코드 오류를 조기에 발견할 수 있으며, 테스트 커버리지가 높아져 코드가 예상대로 동작하는지 확인하는데 도움이 됩니다.
- 좋은 문서화 가능: 시스템 동작 방식에 대해 문서화를 최신 상태로 작성할 수 있습니다. 테스트 코드를 참고하여 이를 파악할 수도 있습니다.
- 빠른 피드백: 테스트를 통해 의도한 대로 동작하는지 확인할 수 있기에 빠르게 피드백을 받을 수 있습니다.
- 효과적인 커뮤니케이션에 도움: 팀이 작성한 코드가 어떻게 동작하는지 같은 시야로 바라볼 수 있기에 의사소통으로 인한 오류나 오해를 방지하고 시간을 줄일 수 있습니다.

반대로 아래와 같은 단점을 가지기도 합니다.

- 초기 개발 속도 저하: 상용 코드 작성 전 테스트 코드를 작성해야 하기에 초기 개발 속도가 느려질 수 있습니다.
- 높은 학습 곡선: TDD를 제대로 적용하기 위해선 높은 숙련도가 필요하며 이를 팀 전원이 능숙하게 사용하기엔 시간이 걸릴 수 있습니다.
- 과도한 의존성: 기능 수정에 따라 테스트 유지보수도 동시에 진행하기 때문에 이에 많은 노력과 시간이 필요합니다.
- 잘못된 테스트의 위험: 정상적으로 테스트가 작성되면 괜찮지만 테스트가 잘못된 경우 개발이 잘못된 방향으로 흘러갈 수 있습니다.

### Bob Martin과 Jim Coplien의 토론

> [!TIP]
>
> 해당 토론의 화자인 Bob Martin은 TDD에 동의하는 입장이고, Jim Coplien은 TDD에 반대하는 입장입니다. 해당 토론의 번역 영상은 아래 [참고](#참고)를 통해 확인할 수 있습니다.

- Bob Martin이 말하는 TDD의 세 가지 법칙
  - 테스트 주도 개발자는 실패하는 단위 테스트를 작성하기 전까지는 한 줄의 상용 코드를 작성하지 않는다.
  - 실패하기에 충분한 양의 단위 테스트만 작성해야 한다. 컴파일이 안 되는 것도 실패에 해당한다.
    - 실제로 동작하는 코드를 작성하기 전에는 단위 테스트 코드를 작성해야 한다.
  - 현재 실패하는 테스트 코드들을 성공시킬 만큼만 상용 코드를 작성해야 한다.
    - 테스트 코드에 맞는 상용 코드를 작성해야 한다.
- Jim Coplien이 말하는 TDD의 두 가지 단점
  - 아키텍처나 프레임워크 없이 TDD를 사용한다.
    - 이는 TDD에 대해서 Kent가 생각한 첫 번째 단계이며, TDD를 사용해 아키텍처를 이끌어야 한다.
    - TDD는 단위 테스트를 하다보니 절차적 상향식 아키텍처를 초래한다.
  - GUI를 망가뜨린다.
    - 절차적 아키텍쳐가 자바 클래스 래퍼 안에 들어가면서 더 이상 시스템 구조를 도메인 지식이나 사용자의 개념 모델에 따라 이끌어 갈 수 없다.
- 소프트웨어 아키텍처에 대하여
  - 공통적으로 아키텍처는 중요하다고 생각한다.
  - 아키텍처는 점진적 시행을 통해 형성된다.
  - 그러나 고객과의 상호작용을 통해 점진적 방식으로 수행하다가도 초기에 도메인 지식 없이 실행하려고 하는 경우 잘못된 결과를 초래할 수 있다.
- 프로페셔널리즘에 대하여
  - Jim Coplien은 프로페셔널이란 일하면서 돈을 벌어내는 사람으로 정의한다.
  - Bob Martin은 개발자가 단위 테스트 하나 없이 배포하는 것은 책임감이 부족한 것이며, TDD를 실천하는 것이 이를 해결하기 위한 최선의 방법이라고 한다.
    - Jim Coplien은 TDD 실천에는 동의하지 않았다.
- TDD와 CDD(Contract-driven development)
  - Jim Coplien이 말하는 CDD
    - 많은 양을 작성하는 단위 테스트는 매우 휴리스틱하고 버그를 발견하는 것은 운이 좋아야 할 정도이다.
    - 그렇기에 계약에 의한 설계(Design by Contract)가 이보다 더욱 강력하다 생각한다.
    - TDD의 모든 장점을 가지며, 코드를 깊이 생각하고 외부 관점에 의해 생각하는 것이 중요하다고 한다.
    - CDD는 계약을 사용하여 무작위 숫자를 입력하고, 전제조건을 충족하지 않으면 실패한 테스트기에 실행하지 않으며 테스트를 통과하면 테스트 후 결과를 확인한다.
  - Bob Martin이 말하는 단위 테스트와 계약
    - 계약과 단위 테스트는 서로 변환될 수 있는 존재이지만 의존성의 방향이 다르다.
      - 단위 테스트는 상용 코드에 의존적이며, 계약은 코드에 묻혀 있다.
  - Jim Coplien의 단위 테스트를 활용하는 코드 지적
    - 단위 테스트를 사용하는 경우 상용 코드와 이의 비율은 반반이다. 이는 성능 저하와 개발 속도 저하를 유발한다.
- 도구의 활용에 대한 견해
  - Bob Martin은 복잡한 코드를 만들 수 있음엔 동의하나, 도구가 남용되기 쉬우니 사용하지 말아야한다는 의견엔 동의하지 않는다고 했다.
  - Jim Coplien은 보편적인 사용 방식을 토대로 말했다고 하면서 잘 사용되지 못하는 경우가 많다고 했다.

> [!NOTE]
>
> **영상에 대한 나의 생각**
>
> 마지막 대화에 이 토론 주제의 본질이 어느 정도 담겨있다고 생각합니다. TDD든 CDD든 원리주의에 빠지지 않고 이 방법론으로 어떤 효과를 만들고 싶은 지에 주목하여 방법론을 수행하는 것이 옳다고 생각합니다.
>
> 또한 그 방법론은 시대와 상황에 따라 옳은 것이 그른 것이 될 수 있고, 그른 것이 옳게 변할 수도 있으니 생각이 고립되지 않도록 자주 재고하는 자세가 중요한 것 같습니다.

## 프론트엔드에서의 TDD

여러 테스트 방법이 있지만 실천까지 옮길 예정이기에 프론트엔드에서의 테스트 만을 알아보도록 하겠습니다.

### 참고

- [GDSC UOS : 프론트엔드에서 TDD로 개발하기](https://gdsc-university-of-seoul.github.io/how-to-develop-frontend-using-TDD/)
- [Youtube : 테스트 주도 개발(TDD)의 장단점: Bob Martin과 Jim Coplien의 토론](https://www.youtube.com/watch?v=eRxc4PD6RN0)
